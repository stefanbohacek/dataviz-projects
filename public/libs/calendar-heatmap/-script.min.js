function calendarHeatmap(){var t=750,e=110,n=150,a="body",r=11,o=2,l=6,i=moment().endOf("day").toDate(),c=moment().startOf("day").subtract(1,"year").toDate(),d={},u=[],s=null,f=["#D8E6E7","#218380"],m=!0,p="contribution",h=!0,g=null,y=0,v={months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["S","M","T","W","T","F","S"],No:"No",on:"on",Less:"Less",More:"More"},x=Number(d3.version.split(".")[0]);function M(){d3.select(M.selector()).selectAll("svg.calendar-heatmap").remove();var a=(d3.time&&d3.time.days||d3.timeDays)(c,i),u=(d3.time&&d3.time.months||d3.timeMonths)(moment(c).startOf("month").toDate(),i),f=moment(a[0]);0==M.data().length?s=0:null===s&&(s=d3.max(M.data(),function(t){return t.count}));var m,h,D=(d3.scale&&d3.scale.linear||d3.scaleLinear)().range(M.colorRange()).domain([0,s]);function Y(t){var e=moment(t).format("YYYY-MM-DD");return d[e]||0}function w(t){return 1===y?0===t?6:t-1:t}!function(){var i=d3.select(M.selector()).style("position","relative").append("svg").attr("width",t).attr("class","calendar-heatmap").attr("height",e).style("padding","36px"),c=(h=i.selectAll(".day-cell").data(a)).enter().append("rect").attr("class","day-cell").attr("width",r).attr("height",r).attr("fill",function(t){return D(Y(t))}).attr("x",function(t,e){var n=moment(t),a=n.week()-f.week()+f.weeksInYear()*(n.weekYear()-f.weekYear());return a*(r+o)}).attr("y",function(t,e){return l+w(t.getDay())*(r+o)});"function"==typeof g&&(3===x?c:c.merge(h)).on("click",function(t){var e=Y(t);g({date:t,count:e})});M.tooltipEnabled()&&(3===x?c:c.merge(h)).on("mouseover",function(t,e){m=d3.select(M.selector()).append("div").attr("class","day-cell-tooltip").html(function(t){var e=moment(t).format("ddd, MMM Do YYYY"),n=Y(t);return"<span><strong>"+(n||v.No)+" "+function(t){if("string"==typeof p)return p+(1===t?"":"s");for(var e in p){var n=p[e],a=n.min,r=n.max||n.min;if(r="Infinity"===r?1/0:r,t>=a&&t<=r)return n.unit}}(n)+"</strong> "+v.on+" "+e+"</span>"}(t)).style("left",function(){return Math.floor(e/7)*r+"px"}).style("top",function(){return w(t.getDay())*(r+o)+2*l+"px"})}).on("mouseout",function(t,e){m.remove()});if(M.legendEnabled()){for(var d=[D(0)],y=3;y>0;y--)d.push(D(s/y));var b=i.append("g");b.selectAll(".calendar-heatmap-legend").data(d).enter().append("rect").attr("class","calendar-heatmap-legend").attr("width",r).attr("height",r).attr("x",function(e,a){return t-n+13*(a+1)}).attr("y",e+o).attr("fill",function(t){return t}),b.append("text").attr("class","calendar-heatmap-legend-text calendar-heatmap-legend-text-less").attr("x",t-n-13).attr("y",e+r).text(v.Less),b.append("text").attr("class","calendar-heatmap-legend-text calendar-heatmap-legend-text-more").attr("x",t-n+o+13*(d.length+1)).attr("y",e+r).text(v.More)}h.exit().remove();i.selectAll(".month").data(u).enter().append("text").attr("class","month-name").text(function(t){return v.months[t.getMonth()]}).attr("x",function(t,e){var n=0;return a.find(function(e,a){return n=a,moment(t).isSame(e,"month")&&moment(t).isSame(e,"year")}),Math.floor(n/7)*(r+o)}).attr("y",0);v.days.forEach(function(t,e){(e=w(e))%2&&i.append("text").attr("class","day-initial").attr("transform","translate(-8,"+(r+o)*(e+1)+")").style("text-anchor","middle").attr("dy","2").text(t)})}();M.data().map(function(t){return t.date.toDateString()})}return M.data=function(t){return arguments.length?(d={},(u=t).forEach(function(t,e){var n=moment(t.date).format("YYYY-MM-DD"),a=d[n]||0;d[n]=a+t.count}),M):u},M.max=function(t){return arguments.length?(s=t,M):s},M.selector=function(t){return arguments.length?(a=t,M):a},M.startDate=function(t){return arguments.length?(c=t,i=moment(t).endOf("day").add(1,"year").toDate(),M):null},M.colorRange=function(t){return arguments.length?(f=t,M):f},M.tooltipEnabled=function(t){return arguments.length?(m=t,M):m},M.tooltipUnit=function(t){return arguments.length?(p=t,M):p},M.legendEnabled=function(t){return arguments.length?(h=t,M):h},M.onClick=function(t){return arguments.length?(g=t,M):g()},M.locale=function(t){return arguments.length?(v=t,M):v},M}Array.prototype.find||(Array.prototype.find=function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),a=n.length>>>0,r=arguments[1],o=0;o<a;o++)if(e=n[o],t.call(r,e,o,n))return e});