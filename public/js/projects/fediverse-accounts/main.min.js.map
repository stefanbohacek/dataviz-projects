{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["/* globals mapboxgl */\n\nimport ready from \"/js/modules/ready.min.js\";\n\nready(async () => {\n  const resp = await fetch(\n    \"https://wikipedia.stefanbohacek.dev/wikidata/?query=SELECT%20DISTINCT%20%3Forg%20%3ForgLabel%20%3ForgTypeLabel%20%3FhostAt%20%3FMastName%20%20WHERE%20%7B%20%20%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%20%20%3Forg%20wdt%3AP4033%20%3FMastName.%0A%20%20%3Forg%20wdt%3AP31%20%3ForgType.%0A%20%20FILTER%20(%3ForgType%20!%3D%20wd%3AQ5).%0A%20%20BIND%20(strafter(%3FMastName%2C%22%40%22)%20AS%20%3FhostAt).%0A%7D%20ORDER%20BY%20%3FhostAt%20LIMIT%2020000%0A&token=lYVGZjrHEUk3DxWm8WgVpExNdj5NHY8x7XiHyt9ltMhKNwbJ1XNwPC22SvoqVR\"\n  );\n\n  const fediverseAccounts = await resp.json();\n\n  const columns = [\n    { title: \"Name\", field: \"name\", headerFilter: \"input\" },\n    {\n      title: \"Type\",\n      field: \"type\",\n      editor: \"input\",\n      headerFilter: \"list\",\n      headerFilterParams: { valuesLookup: true, clearable: true },\n    },\n    { title: \"Account\", field: \"account\", headerFilter: \"input\" },\n    { title: \"Server\", field: \"server\", headerFilter: \"input\" },\n  ];\n\n  let data = [];\n\n  fediverseAccounts.forEach((datapoint, index) => {\n    if (\n      !data\n        .map((account) => account.account)\n        .includes(datapoint?.MastName?.value)\n    ) {\n      data.push({\n        id: index,\n        name: datapoint?.orgLabel?.value,\n        url: datapoint?.org?.value,\n        type: datapoint?.orgTypeLabel?.value,\n        account: `@${datapoint?.MastName?.value}`.replace(\"@@\", \"@\"),\n        server: datapoint?.hostAt?.value,\n      });\n    }\n  });\n\n  document.getElementById(\"count-placeholder\").remove();\n  document.getElementById(\"count\").innerHTML = data.length.toLocaleString();\n  document.getElementById(\"placeholder-table\").remove();\n\n  const table = new Tabulator(\"#data\", {\n    // height: \"500px\",\n    layout: \"fitColumns\",\n    pagination: \"local\",\n    paginationSize: 25,\n    responsiveLayout:true,\n    columns,\n    data,\n  });\n\n  document\n    .getElementById(\"download-csv\")\n    .addEventListener(\"click\", () => {\n      table.download(\"csv\", \"fediverse-accounts.csv\");\n    });\n\n  document\n    .getElementById(\"download-json\")\n    .addEventListener(\"click\", () => {\n      table.download(\"json\", \"fediverse-accounts.json\");\n    });\n\n  document\n    .getElementById(\"download-xlsx\")\n    .addEventListener(\"click\", () => {\n      table.download(\"xlsx\", \"fediverse-accounts.xlsx\", { sheetName: \"My Data\" });\n    });\n\n  document\n    .getElementById(\"download-pdf\")\n    .addEventListener(\"click\", () => {\n      table.download(\"pdf\", \"fediverse-accounts.pdf\", {\n        orientation: \"portrait\", \n        title: \"Fediverse accounts\", \n      });\n    });\n\n  document\n    .getElementById(\"download-html\")\n    .addEventListener(\"click\", () => {\n      table.download(\"html\", \"fediverse-accounts.html\", { style: true });\n    });\n});\n"],"file":"main.min.js"}